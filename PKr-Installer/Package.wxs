<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">

  <Package 
    Id="ButterHost69.PKr_Installer" 
    Name="PKr-Installer" 
    Manufacturer="NemuCorp" 
    Version="0.0.6.9"
    InstallerVersion="500">

	<MajorUpgrade DowngradeErrorMessage="A newer version is already installed." />
    <Media Id="1" Cabinet="media1.cab" EmbedCab="yes" />

    <Directory Id="ProgramFiles64Folder">
      <Directory Id="INSTALLFOLDER" Name="PKr" />
    </Directory>

    <!-- DirectoryRef containing the components -->
    <DirectoryRef Id="INSTALLFOLDER">
      <Component Id="PKrCliComponent" Guid="4e70eb55-fa63-41b1-9f5a-156ad9aa2b62">
    <!--    <File Id="PKrCliFile" Name="PKr-Cli.exe" Source="PKr-Cli.exe" KeyPath="yes" /> -->
        <Environment Id="PKrCliEnvPath" 
                     Name="PATH" 
                     Action="set" 
                     Part="last" 
                     Value="[INSTALLFOLDER]" 
                     Permanent="yes" 
                     System="yes" />
      </Component>

		<Component Id="PKrServiceComponent" Guid="62f5e57c-79bb-4c35-8fda-c72614b6a998">
        <File Id="PKrServiceFile" Name="PKr-Service.exe" Source="PKr-Service.exe" KeyPath="yes" />
        <ServiceInstall Id="PKrServiceInstaller"
                        Type="ownProcess"
                        Vital="yes"
                        Name="PKr-Service"
                        DisplayName="PKr-Service"
                        Start="auto"
                        ErrorControl="normal" />
      </Component>
    </DirectoryRef>

    <!-- Feature references the components -->
    <Feature Id="MainFeature" Title="PKr App Feature" Level="1">
      <ComponentRef Id="PKrCliComponent" />
      <ComponentRef Id="PKrServiceComponent" />
    </Feature>
    
  </Package>

</Wix>
